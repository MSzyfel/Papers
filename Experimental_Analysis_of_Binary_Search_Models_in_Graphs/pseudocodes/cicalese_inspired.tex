
\begin{algorithm}
\caption{Main recursive procedure ($k$ is a global parameter)}\label{cicalese_inspired_pseudocode}
\SetKwFunction{FDecisionTree}{DecisionTree}
\SetKwProg{Fn}{Procedure}{:}{}
\Fn{\FDecisionTree{$\mathcal{T},c$}}{
    \If{$n\br{\mathcal{T}}\leq k$}{
    $D\gets$\FExact{$\mathcal{T},c$}.
    
    \Return $D$
    }
    $\mathcal{X}\gets\emptyset$.
    
    $\mathcal{F}\gets\brc{\mathcal{T}}$.
    
    \For{$1\leq i\leq k$ } 
        {
        \If{$\mathcal{F}=\emptyset$}{
            \textbf{break}
        }
        $H\gets\argmax_{H\in \mathcal{F}}\brc{n\br{H}}$.
        
        $x\gets$ the centroid of $H$.
        
        $\mathcal{X}\gets \mathcal{X}\cup\brc{x}$.
        
        $\mathcal{F}\gets \mathcal{F} \cup H-x$.
        }
    $\mathcal{Z}\gets\mathcal{Y}\gets\mathcal{X}\cup \brc{v\in \mathcal{T}\angl{\mathcal{X}}|\deg_{\mathcal{T}\angl{\mathcal{X}}}\br{v}\geq3}$.
    \tcp{Branching vertices in $\mathcal{T}\angl{X}$.}

    \ForEach{$u,v\in \mathcal{Y},\mathcal{P}_{\mathcal{T}}\br{u, v}\neq\emptyset,\mathcal{P}_{\mathcal{T}}\br{u, v}\cap \mathcal{Y}=\emptyset$}
    {
        $\mathcal{Z}\gets \mathcal{Z}\cup\brc{\argmin_{z\in \mathcal{P}_{\mathcal{T}}\br{u, v}}\brc{c\br{z}}}$. 
        \tcp{Lightest vertex on path $P_\mathcal{T}\br{u,v}$.}
    }
    
    $\mathcal{T}_{\mathcal{Z}}=\br{\mathcal{Z}, \brc{uv|\mathcal{P}_{\mathcal{T}}\br{u, v}\cap \mathcal{Z}=\emptyset}}$.
    
    $D\gets D_{\mathcal{Z}}\gets $\FExact{$\mathcal{T}_{\mathcal{Z}},c$}.

    \ForEach{$H\in \mathcal{T}-\mathcal{Z}$}
    {
        $D_H\gets$\FDecisionTree{$H,c$}.
        
        Hang $D_H$ in $D$ below the last query to a vertex $v \in N_{\mathcal{T}}\br{H}$.
    }
        
    \Return $D$
    
}
\end{algorithm}