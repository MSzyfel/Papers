
\begin{algorithm}
\caption{The \FBuildDT procedure ($c, p, k$, and $d$ are global parameters).}\label{buildDTpseudocode}
\SetKwProg{Fn}{Procedure}{:}{}
\Fn{$\FBuildDT\br{T, c, F_C}$}{
    \If{$c\br{r\br{T}}>pc$}{
        $D\gets\br{\brc{r\br{F_C}}, \emptyset}$.

        \ForEach{\textnormal{$T'\in T-r\br{D}$ and forest $F'_C\subseteq D-r\br{D}$, s. t. $V\br{F'_C} = V\br{T'_C}$}}{
            $D'\gets\FBuildDT\br{T', F'_C}$.

            Hang $D'$ in $D$ below $r\br{D}$.
        }

    }
    \Else{
        $H\gets \brc{v\in V\br{T}|c\br{v} > pk \text{ and for every ancestor $u$ of $v$}, c\br{u}> pk}$.

        $L\gets \brc{v\in V\br{T}|c\br{c}\leq pk}$. 

        \ForEach{\textnormal{$v\in V\br{F_C}$ and ancestor $u$ of $v$ in $F_C$}}
        {
            \If{\textnormal{$v$ is an ancestor of $u$ in $T$}}
            {
                $L$\gets $L - u$
            }
        }
        
        $V_M\gets L\cup H$.

        $M\gets \br{V_M, \brc{uv|u,v\in V_M, \mathcal{P}_{u,v}\cap V_M=\emptyset}}$.

        $\mathcal{A}\gets$ dictionary, such that for each $v\in V_M$, $\mathcal{A}[v]\gets \emptyset$.

        \ForEach{\textnormal{$T'\in T-V_M$ and forest $F'_C\in D-V_M$, s. t. $V\br{F'_C} = V\br{T'_C}$}}
        {
            $D'\gets \FBuildDT\br{T', D'_C}$.

            $\mathcal{A}[p\br{r\br{T'}}]\gets \mathcal{A}[p\br{r\br{T'}}] \cup \brc{D'}$.
        }

        $D\gets \FDPTimelinesCosts\br{M, c}$.

    }
    \Return $D$.
}
\end{algorithm}