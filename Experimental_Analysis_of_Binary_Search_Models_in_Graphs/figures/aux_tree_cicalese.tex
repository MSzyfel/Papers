
\begin{figure}[htp]
    \begin{minipage}[t]{0.45\textwidth}
    \centering
    \begin{tikzpicture}[every node/.style={draw, very thick}, every path/.style={very thick}]

    \node[circle, draw, minimum size=0.15cm, inner sep=0pt, fill=black] (27) at (-2.95,-1.95) {};
    
    \node[circle, draw, minimum size=0.15cm, inner sep=0pt, fill=black] (29) at (-0.5,-2) {};

    
    \node[circle, draw, minimum size=0.15cm, inner sep=0pt, fill=white] (30) at (1,-2.5) {};
    
    \node[circle, draw, minimum size=0.15cm, inner sep=0pt, fill=gray!55] (32) at (1.4,-3) {};

    \node[circle, draw, minimum size=0.15cm, inner sep=0pt, fill=black] (38) at (1.6,-2.79) {};
    \node[circle, draw, minimum size=0.15cm, inner sep=0pt, fill=white] (39) at (1.67,-3.025) {};
    
    \node[circle, draw, minimum size=0.15cm, inner sep=0pt, fill=white] (33) at (1.75,-3.5) {};
    
    \node[circle, draw, minimum size=0.15cm, inner sep=0pt, fill=black] (35) at (2.05,-3.95) {};
    
    \node[circle, draw, minimum size=0.15cm, inner sep=0pt, fill=black] (2) at (-3,3) {};

    
    
    \node[circle, draw, minimum size=0.15cm, inner sep=0pt, fill=black] (4) at (-0.85,2.5) {};
    
    \node[circle, draw, minimum size=0.15cm, inner sep=0pt, fill=white] (5) at (-2.77,2) {};
    
    \node[circle, draw, minimum size=0.15cm, inner sep=0pt, fill=white] (6) at (-0.7,1.25) {};
    ;
    \node[circle, draw, minimum size=0.15cm, inner sep=0pt, fill=black] (8) at (1.75,0.95) {};
    
    \node[circle, draw, inner sep=0pt, fill=white] (9) at (-2.53,1) {};
    
    \node[circle, draw, minimum size=0.15cm, inner sep=0pt, fill=white] (10) at (1,0.65) {};
    
    \node[circle, draw, inner sep=0pt, fill=white] (11) at (0.5,0.47) {};
    
    \node[circle, draw, minimum size=0.15cm, inner sep=0pt, fill=gray!55] (12) at (-0.52,0.1) {};
    
    \node[circle, draw, minimum size=0.15cm, inner sep=0pt, fill=white] (13) at (-0.95,-0.1) {};

    
    \node[circle, draw, minimum size=0.15cm, inner sep=0pt, fill=black] (15) at (-2.2,-0.4) {};
    \node[circle, draw, minimum size=0.15cm, inner sep=0pt, fill=white] (16) at (-2,-0.45) {};
    \node[circle, draw, minimum size=0.15cm, inner sep=0pt, fill=gray!55] (17) at (-1.8,-0.5) {};
    
    \node[circle, draw, minimum size=0.15cm, inner sep=0pt, fill=white] (18) at (-1.35,-1.1) {};

    \node[circle, draw, minimum size=0.15cm, inner sep=0pt, fill=white] (19) at (-2.4,-1.25) {};
    
    \node[circle, draw, inner sep=0pt, fill=white] (20) at (-1.05,-1.45) {};
    
    \node[circle, draw, minimum size=0.15cm, inner sep=0pt, fill=black] (22) at (1.5,-1.55) {};
    
    \node[circle, draw, minimum size=0.15cm, inner sep=0pt, fill=white] (23) at (1,-1.65) {};
    
    \node[circle, draw, minimum size=0.15cm, inner sep=0pt, fill=gray!55] (24) at (0.5,-1.775) {};
    
    \node[circle, draw, minimum size=0.15cm, inner sep=0pt, fill=white] (25) at (0.25,-1.85) {};

    
    
    \draw[] (2) to (5);
    \draw[] (4) to (6);
    \draw[] (5) to (9);
    \draw[] (6) to (12);
    \draw[] (8) to (10);
    \draw[] (9) to (15);
    \draw[] (10) to (11);
    \draw[] (11) to (12);
    \draw[] (12) to (13);
    \draw[] (13) to (17);
    \draw[] (15) to (16);
    \draw[] (16) to (17);
    \draw[] (17) to (18);
    \draw[] (17) to (19);
    \draw[] (18) to (20);
    \draw[] (19) to (27);
    \draw[] (20) to (29);
    \draw[] (22) to (23);
    \draw[] (23) to (24);
    \draw[] (24) to (25);
    \draw[] (24) to (30);
    \draw[] (25) to (29);
    \draw[] (30) to (32);
    \draw[] (32) to (33);
    \draw[] (32) to (39);
    \draw[] (33) to (35);
    \draw[] (38) to (39);

    \draw[very thick, fill=gray!20, drop shadow]
    (2).. controls +(-40:2.5cm) and +(40:2.5cm).. (2);

    \draw[very thick, fill=gray!20, drop shadow]
    (9).. controls +(-120:1.5cm) and +(-200:1.5cm).. (9);

    \draw[very thick, fill=gray!20, drop shadow]
    (11).. controls +(-50:3cm) and +(-130:3cm).. (11);

    \draw[very thick, fill=gray!20, drop shadow]
    (20).. controls +(-105:2cm) and +(-185:2cm).. (20);

    \draw[very thick, fill=gray!20, drop shadow]
    (4).. controls +(30:3cm) and +(-50:3cm).. (4);

    \draw[very thick, fill=gray!20, drop shadow]
    (32).. controls +(-80:2cm) and +(-160:2cm).. (32);

    \draw[very thick, fill=gray!20, drop shadow]
    (4).. controls +(-100:1.75cm) and +(-180:1.75cm).. (4);

    \draw[very thick, fill=gray!20, drop shadow]
    (8).. controls +(180:1.5cm) and +(100:1.5cm).. (8);

     \draw[very thick, fill=gray!20, drop shadow]
    (10).. controls +(0:2.5cm) and +(-80:2.5cm).. (10);


    \draw[very thick, fill=gray!20, drop shadow]
    (15).. controls +(-200:1.5cm) and +(-120:1.5cm).. (15);

    \draw[very thick, fill=gray!20, drop shadow]
    (17).. controls +(125:1cm) and +(45:1cm).. (17);

    
    \draw[very thick, fill=gray!20, drop shadow]
    (22).. controls +(0:1.75cm) and +(-80:1.75cm).. (22);

     \draw[very thick, fill=gray!20, drop shadow]
    (27).. controls +(-20:3.5cm) and +(-100:3.5cm).. (27);

    
    \draw[very thick, fill=gray!20, drop shadow]
    (29).. controls +(-40:3cm) and +(-120:3cm).. (29);

    \draw[very thick, fill=gray!20, drop shadow]
    (29).. controls +(120:1.5cm) and +(30:1.5cm).. (29);

    \draw[very thick, fill=gray!20, drop shadow]
    (35).. controls +(-40:1cm) and +(-120:1cm).. (35);

    \draw[very thick, fill=gray!20, drop shadow]
    (38).. controls +(-20:0.8cm) and +(60:0.8cm).. (38);

    
    \end{tikzpicture}
    \caption[Example tree $\mathcal{T}$ with sets $\mathcal{X},\mathcal{Y},\mathcal{Z}$]{Example tree $\mathcal{T}$. Light grey regions represent light subtrees. Black vertices represent $\mathcal{X}$. Gray and black vertices represent $\mathcal{Y}$. White, gray and black vertices represent $\mathcal{Z}$. Lines represent paths of vertices between vertices of $\mathcal{Z}$.}\label{exampleTreeWithSetZcicalese}
\end{minipage}
    \hspace{0.06\textwidth} % Add space between the two minipages
    \begin{minipage}[t]{0.45\textwidth}
    \centering
    \begin{tikzpicture}[every node/.style={draw, very thick, drop shadow}, every path/.style={very thick}]
    
    \node[circle, draw, minimum size=0.3cm, inner sep=0pt, fill=black] (2) at (-3,4) {};

    
    
    \node[circle, draw, minimum size=0.3cm, inner sep=0pt, fill=black] (4) at (-0.85,3.5) {};
    

    
    \node[circle, draw, minimum size=0.3cm, inner sep=0pt, fill=white] (5) at (-2.77,3) {};
    
    \node[circle, draw, minimum size=0.3cm, inner sep=0pt, fill=white] (6) at (-0.7,2.25) {};
    
    \node[circle, draw, minimum size=0.3cm, inner sep=0pt, fill=black] (8) at (2,2) {};
    
    
    \node[circle, draw, minimum size=0.3cm, inner sep=0pt, fill=white] (10) at (1,1.65) {};
    
    
    \node[circle, draw, minimum size=0.3cm, inner sep=0pt, fill=gray!55] (12) at (-0.52,1.1) {};
    
    \node[circle, draw, minimum size=0.3cm, inner sep=0pt, fill=white] (13) at (-0.95,0.9) {};

    
    \node[circle, draw, minimum size=0.3cm, inner sep=0pt, fill=black] (15) at (-2.5,0.6) {};
    \node[circle, draw, minimum size=0.3cm, inner sep=0pt, fill=white] (16) at (-2,0.55) {};
    \node[circle, draw, minimum size=0.3cm, inner sep=0pt, fill=gray!55] (17) at (-1.5,0.5) {};
    
    \node[circle, draw, minimum size=0.3cm, inner sep=0pt, fill=white] (18) at (-1.35,-0.1) {};

    \node[circle, draw, minimum size=0.3cm, inner sep=0pt, fill=white] (19) at (-2.4,-0.25) {};
    
    
    \node[circle, draw, minimum size=0.3cm, inner sep=0pt, fill=black] (22) at (1.5,-0.55) {};
    
    \node[circle, draw, minimum size=0.3cm, inner sep=0pt, fill=white] (23) at (1,-0.65) {};
    
    \node[circle, draw, minimum size=0.3cm, inner sep=0pt, fill=gray!55] (24) at (0.5,-0.775) {};
    
    \node[circle, draw, minimum size=0.3cm, inner sep=0pt, fill=white] (25) at (0,-0.85) {};

    \node[circle, draw, minimum size=0.3cm, inner sep=0pt, fill=black] (27) at (-2.95,-0.95) {};
    
    \node[circle, draw, minimum size=0.3cm, inner sep=0pt, fill=black] (29) at (-0.5,-1) {};

    
    \node[circle, draw, minimum size=0.3cm, inner sep=0pt, fill=white] (30) at (1,-1.5) {};
    
    \node[circle, draw, minimum size=0.3cm, inner sep=0pt, fill=gray!55] (32) at (1.4,-2) {};
    \node[circle, draw, minimum size=0.3cm, inner sep=0pt, fill=black] (38) at (1.9,-1.55) {};
    \node[circle, draw, minimum size=0.3cm, inner sep=0pt, fill=white] (39) at (1.8,-1.95) {};
    
    \node[circle, draw, minimum size=0.3cm, inner sep=0pt, fill=white] (33) at (2,-2.5) {};
    
    \node[circle, draw, minimum size=0.3cm, inner sep=0pt, fill=black] (35) at (2.55,-2.95) {};
    
    \draw[] (2) to (5);
    \draw[] (4) to (6);
    \draw[] (5) to (15);
    \draw[] (6) to (12);
    \draw[] (8) to (10);
    \draw[] (10) to (12);
    \draw[] (12) to (13);
    \draw[] (13) to (17);
    \draw[] (15) to (16);
    \draw[] (16) to (17);
    \draw[] (17) to (18);
    \draw[] (17) to (19);
    \draw[] (18) to (29);
    \draw[] (19) to (27);
    \draw[] (22) to (23);
    \draw[] (23) to (24);
    \draw[] (24) to (25);
    \draw[] (24) to (30);
    \draw[] (25) to (29);
    \draw[] (30) to (32);
    \draw[] (32) to (33);
    \draw[] (32) to (39);
    \draw[] (33) to (35);
    \draw[] (38) to (39);
    \end{tikzpicture}
    \caption{Auxiliary tree $\mathcal{T}_{\mathcal{Z}}$ built from vertices of set $\mathcal{Z}$.}\label{exampleAuxTreeTZcicalese}
\end{minipage}
\begin{minipage}[t]{1\textwidth}
\centering
    \begin{tikzpicture}[scale=1.1]
    \draw[very thick, fill=gray, drop shadow] 
    (4,-3.4) -- (5.2,-5.8) -- (2.8,-5.8) -- cycle; 


    \draw[very thick, fill=gray!20, drop shadow] (2,-6.6) -- (2.9,-8.4) -- (1.1,-8.4) -- cycle;

    \draw[very thick, fill=gray!20, drop shadow] (4,-6.5) -- (4.8,-8.1) -- (3.2,-8.1) -- cycle;
    
    \node at (5.2, -7.3) {$\dots$}; 

    \draw[very thick, fill=gray!20, drop shadow] (6.4,-6.4) -- (5.7,-7.8) -- (7.1,-7.8) -- cycle;
    
    \draw[very thick] (2.8,-5.8) -- (2,-6.6);
    \draw[very thick] (4.2,-5.8) -- (4,-6.5);
    \draw[very thick] (5.2,-5.8) -- (6.4,-6.4);

    \draw [decorate, 
       decoration = {calligraphic brace, amplitude = 10pt, mirror}, 
       line width = 1.5pt] 
      (0.5,-3.25) -- (0.5,-8.45);

    \node at (-0.6, -5.85) {$\COST_{D}\br{\mathcal{T}}$};
        
    \end{tikzpicture}
    \caption[Auxiliary tree $\mathcal{T_{\mathcal{Z}}}$ construction and the structure of the decison tree $D_{\mathcal{Z}}$]{The structure of the decision tree $D$, built by the Algorithm \ref{cicalese_inspired_pseudocode}. The dark gray subtree represents the decision tree $D_{\mathcal{Z}}$, obtained by calling the \texttt{Exact} procedure for $\mathcal{T}_{\mathcal{Z}}$ and $c$. Light gray subtrees represent decision trees $D_L$, built for each $H\in \mathcal{T}-\mathcal{Z}$, by recursively calling \textsc{DecisionTree} with $H$ and $c$.}\label{structure_of_dt_cicalese}
\end{minipage}
\end{figure}